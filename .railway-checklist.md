# Railway Deployment Checklist

## âœ… Pre-Deployment (Local)

- [x] `railway.toml` exists (defines volume)
- [ ] Push all changes to git

## âœ… Railway Setup

### Step 1: Deploy
```bash
git push
# or
railway up
```

### Step 2: Verify Volume Created
After first deployment, check logs for:
```
Session path: /data/whatsapp-session
Database initialized at: /data/scheduled.db
```

**If you see `/data/` in paths â†’ Volume is working! âœ…**

**If you see `./whatsapp-session` or `./scheduled.db` â†’ Volume not mounted! âŒ**

### Step 3: Set Environment Variables

In Railway Dashboard â†’ Your Service â†’ **Variables** tab:

```bash
DATABASE_PATH=/data/scheduled.db
SESSION_PATH=/data/whatsapp-session
```

Click **"Add"** for each one.

### Step 4: Redeploy
After adding variables:
- Railway will auto-redeploy
- Or click **"Redeploy"** manually

## âœ… Verification

### Check Deployment Logs:

1. Go to: **Deployments** tab â†’ Latest deployment â†’ **View Logs**

2. Look for these SUCCESS messages:
```
âœ… Database initialized at: /data/scheduled.db
âœ… Session path: /data/whatsapp-session
âœ… WhatsApp client initializing...
âœ… Server running on port 3000
```

3. First time only - QR Code will appear:
```
ğŸ“· QR Code received
â–ˆâ–€â–€â–€â–€â–€â–ˆ ... (ASCII QR code)
```

### Scan QR Code:

1. Open WhatsApp on your phone
2. Settings â†’ Linked Devices â†’ Link a Device
3. Scan the QR code from logs
4. Wait for: `âœ… WhatsApp authenticated`
5. Wait for: `WhatsApp client is ready!`

### Verify Scheduler Running:

Look for every minute:
```
Scheduler tick: 2025-12-22T08:05:00.007Z
No pending messages to send
```

## âœ… Test It Works

Send a message to yourself in WhatsApp:
```
/send Mom in 1 minute test
```

Check logs for:
```
Processing /send command...
âœ… Message scheduled!
```

After 1 minute, check for:
```
Found 1 pending message(s) to send
Sending message 8 to +972501234567
âœ… Message sent successfully
```

## ğŸ”§ Troubleshooting

### Volume not working (paths show ./ instead of /data/)?

**Option 1: Check railway.toml deployed**
```bash
railway logs | grep "Session path"
```
Should show: `/data/whatsapp-session`

**Option 2: Manually add volume in UI**

See RAILWAY_SETUP.md for UI locations.

**Option 3: Check Hobby plan**
- Free trial doesn't support volumes
- Need Hobby plan ($5/month)

### Variables not applying?

1. Make sure you clicked **"Add"** not just typed them
2. Check **Variables** tab shows both variables
3. Redeploy after adding variables

### WhatsApp not connecting?

1. Check QR code in logs (expires after 60 seconds)
2. If expired, Railway will restart and show new QR
3. Make sure phone has internet connection
4. Scan QR code quickly!

## ğŸ‰ Success!

When you see all of these:
- âœ… Volume mounted at /data
- âœ… Environment variables set
- âœ… WhatsApp authenticated and ready
- âœ… Scheduler ticking every minute
- âœ… Frontend accessible at your Railway URL

**You're done!** ğŸš€

Visit: `https://your-app.railway.app`
